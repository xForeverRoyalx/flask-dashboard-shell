{% extends "dashboard/dashboard_base.html" %}

{% block page_title %}Profile{% endblock %}

{% block content %}

<!-- Page header -->
<header class="page-header animate-fade-up">
  <div class="page-header__eyebrow">Account</div>
  <h1 class="page-header__title">Your Profile</h1>
  <p class="page-header__subtitle">
    Review and manage your account details below.
  </p>
</header>

<!-- Profile layout: avatar + details + actions -->
<div class="grid grid--2 animate-fade-up delay-1" style="align-items: start; max-width: 820px;">

  <!-- Left: avatar + quick info -->
  <div class="card card--flat flex-col items-center" style="text-align:center; gap: var(--space-5); padding: var(--space-8);">
	<div class="avatar--xl" aria-hidden="true">
	  {% if current_user.avatar_url %}
	  <img src="{{ current_user.avatar_url }}" alt="Avatar" style="width:100%;height:100%;object-fit:cover;border-radius:9999px;" />
	  {% else %}
	  {{ (current_user.first_name[0] ~ current_user.last_name[0]) | upper if current_user.first_name else '?' }}
	  {% endif %}
	</div>
    <div class="flex-col" style="gap: var(--space-1); align-items: center;">
      <h2 style="font-size: var(--text-xl); margin: 0;">
        {{ account.first_name }} {{ account.last_name }}
      </h2>
      <span class="text-xs text-muted uppercase tracking-wider">Account Member</span>
    </div>

    <div style="width: 100%;">
      <div class="profile-email-status">
        {% if account.email_confirmed %}
        <span class="badge badge--success">Email confirmed</span>
        {% else %}
        <span class="badge badge--warning">Email unconfirmed</span>
        {% endif %}
      </div>
    </div>

    <a href="{{ url_for('dashboard.account_edit') }}" class="btn btn--ghost w-full" style="justify-content:center;">
      <svg width="13" height="13" viewBox="0 0 13 13" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
        <path d="M9.5 1.5l2 2L4 11H2v-2L9.5 1.5z"/>
      </svg>
      Edit profile
    </a>
  </div>

  <!-- Right: field details -->
  <div class="card animate-fade-up delay-2">
    <div class="card__header">
      <span class="card__title">Account Details</span>
    </div>

    <div class="profile-field">
      <span class="profile-field__label">First name</span>
      <span class="profile-field__value">{{ account.first_name }}</span>
    </div>

    <div class="profile-field">
      <span class="profile-field__label">Last name</span>
      <span class="profile-field__value">{{ account.last_name }}</span>
    </div>

    <div class="profile-field">
      <span class="profile-field__label">Email address</span>
      <div class="flex items-center gap-2" style="flex-wrap: wrap;">
        <span class="profile-field__value font-mono" style="font-size: var(--text-sm);">
          {{ account.email }}
        </span>
        {% if account.email_confirmed %}
        <span class="badge badge--success" style="font-size: var(--text-2xs);">✓ Confirmed</span>
        {% else %}
        <span class="badge badge--warning" style="font-size: var(--text-2xs);">Unconfirmed</span>
        {% endif %}
      </div>
      {% if not account.email_confirmed %}
      <span class="form-hint mt-4">
        <a href="#" class="text-accent" style="font-size: var(--text-xs);">Resend confirmation email →</a>
      </span>
      {% endif %}
    </div>

    <div class="profile-field">
      <span class="profile-field__label">Member since</span>
      <span class="profile-field__value text-secondary" style="font-size: var(--text-sm);">
        Today
      </span>
    </div>

  </div><!-- /card -->

</div><!-- /grid -->

<!-- Dev reset link — remove in production -->
<p class="text-xs text-muted" style="margin-top: var(--space-8);">
  Dev: <a href="{{ url_for('dashboard.dev_reset') }}" class="text-accent" style="font-size: var(--text-xs);">Reset session →</a>
</p>

{% endblock %}